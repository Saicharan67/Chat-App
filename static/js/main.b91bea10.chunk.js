(this.webpackJsonpchatapp=this.webpackJsonpchatapp||[]).push([[0],{48:function(e,t,a){e.exports=a(87)},53:function(e,t,a){},58:function(e,t,a){},60:function(e,t,a){},79:function(e,t,a){},80:function(e,t,a){e.exports=a.p+"static/media/StartChat2.b72f9c93.svg"},81:function(e,t,a){},82:function(e,t,a){e.exports=a.p+"static/media/login.303e4a67.svg"},83:function(e,t,a){},84:function(e,t,a){},85:function(e,t,a){e.exports=a.p+"static/media/sign.a32792fd.svg"},87:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(34),s=a.n(r),i=(a(53),a(15)),o=a(25),l=a(8),u=(a(58),a(47)),m=function(e){var t=e.component,a=Object(u.a)(e,["component"]);return c.a.createElement(l.b,Object.assign({},a,{component:function(e){var a=localStorage.getItem("users")?JSON.parse(localStorage.getItem("users")):null;return console.log(a),a?c.a.createElement(t,e):c.a.createElement(l.a,{to:"/login"})}}))},d=a(13),p=(a(60),a(14)),f=a.n(p),h=a(24),g=a(17),E=a.n(g),b="USER_LOGIN",v="USERLOGOUT",O="GET_REAL_TIME_USERS",S=" GET_REALTIME_MESSAGES",y="GET_REALTIME_NEW_MESSAGES",j=a(9),N=function(e){return function(){var t=Object(h.a)(f.a.mark((function t(a){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Object(g.firestore)().collection("conversation").where("isView","==",!1).onSnapshot((function(t){var n={};t.forEach((function(t){t.data().user_uid_2===e&&(n[t.data().user_uid_1]=n[t.data().user_uid_1]?n[t.data().user_uid_1]+1:1)})),a({type:y,payload:{messages:n}})}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},w=function(e){var t=Object(i.c)((function(e){return e.auth})),a=Object(i.b)(),r=Object(n.useState)(!1),s=Object(d.a)(r,2),l=s[0],u=s[1];return c.a.createElement("header",{className:t.authenticated?"header":"loginheader"},c.a.createElement("div",{style:{display:"flex"}},c.a.createElement("div",{className:"logo"},"Chat-App")),c.a.createElement("div",{style:{margin:"20px 0",color:"#fff",fontWeight:"3rem"}},t.authenticated?"Hi ".concat(t.FirstName," ").concat(t.LastName):""),c.a.createElement("ul",{className:"menu"},t.authenticated?c.a.createElement("li",null,c.a.createElement(o.b,{className:"logout",to:"#",onClick:function(){var e;u(!0),a((e=t.uid,function(){var t=Object(h.a)(f.a.mark((function t(a){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a({type:"".concat(v,"_REQUEST")}),Object(g.firestore)().collection("users").doc(e).update({isOnline:!1}).then((function(){Object(g.auth)().signOut().then((function(){localStorage.clear(),a({type:"".concat(b,"_SUCCESS")})})).catch((function(e){a({type:"".concat(b,"_FAILURE"),payload:{error:e}})}))})).catch((function(e){console.log(e)}));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()))}},l?c.a.createElement("i",{style:{fontSize:"20px"},className:"fa fa-spinner fa-spin "}):"Logout")):null),t.authenticated?null:c.a.createElement("ul",{className:"RightMenu"},c.a.createElement("li",null,c.a.createElement(o.c,{to:"./login"},"Login")),c.a.createElement("li",null,c.a.createElement(o.c,{to:"./signup"},"Signup"))))},_=function(e){return c.a.createElement("div",null,c.a.createElement(w,null),e.children)},C=a(44),k=a.n(C),U=(a(77),a(46)),L=(a(79),function(e){var t=e.user,a=e.onClick,n=e.newmessages;return c.a.createElement("div",{onClick:function(e){return a(t,e)},key:t.uid,className:"displayName"},c.a.createElement("div",{className:"item"},n&&n[t.uid]?c.a.createElement("span",{className:"notify-badge"},n[t.uid]):"",c.a.createElement("img",{className:"Dp",src:"https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcTr3k-GgfticbNEipXYeXapEpiiawOSHjXfsQ&usqp=CAU",alt:"Dp"})),c.a.createElement("div",{className:"displayPerson",style:{display:"flex",flex:1,justifyContent:"space-between",margin:"0 10px",pointerEvents:"none"}},c.a.createElement("span",{style:{fontWeight:500}},t.FirstName," ",t.LastName),c.a.createElement("span",{className:t.isOnline?"onlineStatus":"onlineStatus off"},t.isOnline?c.a.createElement("i",{style:{color:"green"},className:"fa fa-dot-circle-o","aria-hidden":"true"}):c.a.createElement("i",{style:{color:"red"},className:"fa fa-dot-circle-o","aria-hidden":"true"}))))}),x=function(e){var t,r=Object(i.c)((function(e){return e.user})),s=Object(i.b)(),o=Object(i.c)((function(e){return e.auth})),l=Object(i.c)((function(e){return e.user.newmessages})),u=Object(n.useState)(!1),m=Object(d.a)(u,2),p=m[0],E=m[1],b=Object(n.useState)(""),v=Object(d.a)(b,2),y=v[0],w=v[1],C=Object(n.useState)(""),x=Object(d.a)(C,2),A=x[0],I=x[1],R=Object(n.useState)(""),F=Object(d.a)(R,2),T=F[0],B=F[1],M=Object(n.useState)(!1),z=Object(d.a)(M,2),D=z[0],G=z[1],Q=T==r.talkingwith;Object(n.useEffect)((function(){var e;t=s((e=o.uid,function(){var t=Object(h.a)(f.a.mark((function t(a){var n,c;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a({type:"".concat(O,"_REQUEST")}),n=Object(g.firestore)(),c=n.collection("users").onSnapshot((function(t){var n=[];t.forEach((function(t){t.data().uid!==e&&n.push(t.data())})),console.log(n),a({type:"".concat(O,"_SUCCESS"),payload:{users:n}})})),t.abrupt("return",c);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())).then((function(e){return e})).catch((function(e){console.log(e)}))}),[]),Object(n.useEffect)((function(){return function(){t.then((function(e){return e()})).catch((function(e){return console.log(e)}))}}),[]),Object(n.useEffect)((function(){s(N(o.uid))}),[]);var P=function(e,t){var a=document.getElementsByClassName("messageSections")[0];a.scrollTop=a.scrollHeight,E(!0),B(e.uid),w("".concat(e.FirstName," ").concat(e.LastName));for(var n,c=document.getElementsByClassName("displayName"),r=0;r<c.length;r++)c[r].className="displayName";t.target.className="displayName active",s(function(e){return function(){var t=Object(h.a)(f.a.mark((function t(a){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Object(g.firestore)().collection("conversation").orderBy("createdAt","asc").onSnapshot((function(t){var n=[];t.forEach((function(t){(t.data().user_uid_1===e.uid_1&&t.data().user_uid_2===e.uid_2||t.data().user_uid_1===e.uid_2&&t.data().user_uid_2===e.uid_1)&&n.push(t.data())}));var c=e.uid_2;a({type:S,payload:{conversations:n,talkingwith:c}}),console.log(n)}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}({uid_1:o.uid,uid_2:e.uid})),s(N(o.uid)),s((n={uid_1:o.uid,uid_2:e.uid},Object(h.a)(f.a.mark((function e(){var t,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Object(g.firestore)(),a=t.collection("conversation").where("isView","==",!1).where("user_uid_2","==",n.uid_1).where("user_uid_1","==",n.uid_2).onSnapshot((function(e){e.forEach((function(e){e.data().user_uid_1==n.uid_2&&e.data().user_uid_2==n.uid_1&&t.collection("conversation").doc(e.id).update({isView:!0}).then((function(){})).catch((function(){console.log("NotViewed")}))}))})),setInterval((function(){a()}),2e3);case 3:case"end":return e.stop()}}),e)}))))),console.log(o.uid,e.uid)},V=function(){var e=document.getElementsByClassName("messageSections")[0];e.scrollTop=e.scrollHeight;var t={user_uid_1:o.uid,user_uid_2:T,message:A};""!==A&&s(function(e){return function(){var t=Object(h.a)(f.a.mark((function t(a){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Object(g.firestore)().collection("conversation").add(Object(j.a)(Object(j.a)({},e),{},{isView:!1,createdAt:new Date})).then((function(e){console.log(e,"msg updated")})).catch((function(e){console.log(e)}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(t)).then((function(){I("")}))};return c.a.createElement(_,null,c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"listOfUsers"},r.users.length>0?r.users.map((function(e){return c.a.createElement(L,{onClick:P,key:e.uid,user:e,newmessages:l})})):null),c.a.createElement("div",{className:"chatArea"},c.a.createElement("div",{className:"chatHeader"},p?y:"Start Chating By Clicking On Users"),c.a.createElement("div",{className:"messageSections"},p?Q?r.conversations.map((function(e,t){return c.a.createElement("div",{key:t,className:e.user_uid_1===o.uid?"sent":"received",style:{textAlign:e.user_uid_1===o.uid?"right":"left",marginTop:0===t?"15px":"2px"}},c.a.createElement("p",{className:e.user_uid_1===o.uid?0==t||r.conversations[t-1].user_uid_1!==o.uid?"messagestyleright":"normalrightmessage":0==t||r.conversations[t-1].user_uid_1===o.uid?"messagestyleleft":"normalleftmessage"},e.message),e.user_uid_1===o.uid?e.isView?c.a.createElement("svg",{width:"1em",height:"1em",viewBox:"0 0 16 16",className:"bi bi-check2-all",fill:"blue",xmlns:"http://www.w3.org/2000/svg"},c.a.createElement("path",{fillrule:"evenodd",d:"M12.354 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"}),c.a.createElement("path",{d:"M6.25 8.043l-.896-.897a.5.5 0 1 0-.708.708l.897.896.707-.707zm1 2.414l.896.897a.5.5 0 0 0 .708 0l7-7a.5.5 0 0 0-.708-.708L8.5 10.293l-.543-.543-.707.707z"})):c.a.createElement("svg",{width:"1em",height:"1em",viewBox:"0 0 16 16",className:"bi bi-check2-all",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},c.a.createElement("path",{"fill-rule":"evenodd",d:"M12.354 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"}),c.a.createElement("path",{d:"M6.25 8.043l-.896-.897a.5.5 0 1 0-.708.708l.897.896.707-.707zm1 2.414l.896.897a.5.5 0 0 0 .708 0l7-7a.5.5 0 0 0-.708-.708L8.5 10.293l-.543-.543-.707.707z"})):"")})):Q=!Q:c.a.createElement("img",{className:"startchat",src:a(80)})),p?c.a.createElement("div",{className:"chatControls"},c.a.createElement("div",null,c.a.createElement("i",{className:"fi fa fa-smile-o fa-2x",onClick:function(){return console.log("opened"),void G(!0)}})),c.a.createElement("div",{style:{width:"90%",position:"relative",display:"flex",justifyContent:"center",alignItems:"center"}},c.a.createElement("input",{className:"textarea",value:A,placeholder:"Enter Message..",onChange:function(e){return I(e.target.value)},onKeyDown:function(e){if("Enter"===e.key)return V()}})),c.a.createElement("button",{className:"SendButton",onClick:V},c.a.createElement("i",{className:"fa fa-send-o"}))):"",c.a.createElement(k.a,{effect:"fadeInUp",onClickAway:function(){return console.log("closed"),void G(!1)},visible:D},c.a.createElement(U.a,{onSelect:function(e){var t=e.native;I(A+t),console.log(t)}})))))},A=(a(81),function(e){var t=Object(i.b)(),r=Object(i.c)((function(e){return e.auth})),s=Object(n.useState)(""),o=Object(d.a)(s,2),u=o[0],m=o[1],p=Object(n.useState)(""),E=Object(d.a)(p,2),v=E[0],O=E[1],S=Object(n.useState)(!1),y=Object(d.a)(S,2),j=y[0],N=y[1],w=Object(n.useState)(!1),C=Object(d.a)(w,2),k=C[0],U=C[1];return r.authenticated?c.a.createElement(l.a,{to:"/Chat-App"}):k?c.a.createElement(l.a,{to:"/signup"}):c.a.createElement(_,null,c.a.createElement("div",{className:"body"},c.a.createElement("div",{className:"app"},c.a.createElement("div",{className:"bg"},c.a.createElement("form",null,c.a.createElement("header",null,c.a.createElement("img",{src:a(82)})),c.a.createElement("div",{className:"inputs"},c.a.createElement("input",{type:"email",name:"email",placeholder:"Email",value:u,onChange:function(e){m(e.target.value)}}),c.a.createElement("input",{type:"password",name:"password",placeholder:"password",value:v,onChange:function(e){O(e.target.value)}}),c.a.createElement("p",{className:"light"},c.a.createElement("a",{href:"#"},"Forgot password?"))))),c.a.createElement("footer",null,c.a.createElement("button",{className:"LoginButton",onClick:function(e){var a;(N(!0),e.preventDefault(),""!==u)?""!==v?t((a={email:u,password:v},function(){var e=Object(h.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"".concat(b,"_REQUEST")}),n=Object(g.firestore)(),Object(g.auth)().signInWithEmailAndPassword(a.email,a.password).then((function(e){console.log("SignIn Data",e),n.collection("users").doc(e.user.uid).update({isOnline:!0}).then((function(){var a=e.user.displayName.split(" "),n={FirstName:a[0],LastName:a[1],uid:e.user.uid,email:e.user.email};localStorage.setItem("users",JSON.stringify(n)),t({type:"".concat(b,"_SUCCESS"),payload:{user:n}}),console.log("Logged In successfully")})).catch((function(e){alert(e)}))})).catch((function(e){alert(e),t({type:"".concat(b,"_FAILURE"),payload:{err:e}})}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())):alert("Password Is Required"):alert("Email Is Required")}},j?c.a.createElement("i",{style:{fontSize:"20px"},className:"fa fa-spinner fa-spin "}):"Continue"),c.a.createElement("p",null,"Don't have an account?  \xa0 \xa0 ",c.a.createElement("h4",{onClick:function(){U(!0)}},"Sign Up"))))))}),I=(a(83),a(84),function(e){var t=Object(n.useState)(""),r=Object(d.a)(t,2),s=r[0],o=r[1],u=Object(n.useState)(""),m=Object(d.a)(u,2),p=m[0],E=m[1],v=Object(n.useState)(""),O=Object(d.a)(v,2),S=O[0],y=O[1],j=Object(n.useState)(""),N=Object(d.a)(j,2),w=N[0],C=N[1],k=Object(i.b)(),U=Object(n.useState)(!1),L=Object(d.a)(U,2),x=L[0],A=L[1],I=Object(i.c)((function(e){return e.auth})),R=Object(n.useState)(!1),F=Object(d.a)(R,2),T=F[0],B=F[1];return I.authenticated?c.a.createElement(l.a,{to:"/Chat-App"}):T?c.a.createElement(l.a,{to:"/login"}):c.a.createElement(_,null,c.a.createElement("div",{className:"body2"},c.a.createElement("div",{class:"app2"},c.a.createElement("div",{className:"bg2"},c.a.createElement("form",{className:"signinform"},c.a.createElement("img",{className:"Signimg",src:a(85)}),c.a.createElement("div",{className:"Signinputs"},c.a.createElement("input",{name:"FirstName",type:"FirtName",value:s,onChange:function(e){o(e.target.value)},placeholder:"FirstName"}),c.a.createElement("input",{name:"LastName",type:"LastName",value:p,onChange:function(e){E(e.target.value)},placeholder:"LastName"}),c.a.createElement("input",{name:"email",type:"email",value:S,onChange:function(e){y(e.target.value)},placeholder:"Email.."}),c.a.createElement("input",{name:"password",type:"password",value:w,onChange:function(e){C(e.target.value)},placeholder:"Password"})))),c.a.createElement("footer",null,c.a.createElement("button",{className:"SignUpButton",onClick:function(e){A(!0),document.getElementsByClassName("SignUpButton")[0].innerHTML='<i className="fa fa-spinner fa-spin">',e.preventDefault(),k(function(e){return function(){var t=Object(h.a)(f.a.mark((function t(a){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=Object(g.firestore)(),a({type:"".concat(b,"_REQUEST")}),Object(g.auth)().createUserWithEmailAndPassword(e.email,e.password).then((function(t){var c=Object(g.auth)().currentUser,r="".concat(e.FirstName," ").concat(e.LastName);c.updateProfile({displayName:r}).then((function(){console.log(t),n.collection("users").doc(t.user.uid).set({FirstName:e.FirstName,LastName:e.LastName,uid:t.user.uid,createdAt:new Date,isOnline:!0}).then((function(){var n={FirstName:e.FirstName,LastName:e.LastName,uid:t.user.uid,email:e.email};localStorage.setItem("users",JSON.stringify({loggedInUser:n})),console.log("Sign Up  success"),a({type:"".concat(b,"_SUCCESS"),payload:{user:n}})})).catch((function(e){alert(e),a({type:"".concat(b,"_FAILURE"),payload:{err:e}})}))}))})).catch((function(e){return alert(e)}));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}({FirstName:s,LastName:p,email:S,password:w}))}},x?c.a.createElement("i",{style:{fontSize:"20px"},className:"fa fa-spinner fa-spin "}):"Sign Up"),c.a.createElement("p",{className:"p"},"Already a User ?\xa0 \xa0",c.a.createElement("h4",{onClick:function(){B(!0)}}," Login"))))))});var R=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.auth}));return Object(n.useEffect)((function(){t.authenticated||e(function(){var e=Object(h.a)(f.a.mark((function e(t){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=localStorage.getItem("users")?JSON.parse(localStorage.getItem("users")):null,t(a?{type:"".concat(b,"_SUCCESS"),payload:{user:a}}:{type:"".concat(b,"_FAILURE"),payload:{err:"Login Again Please"}});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),c.a.createElement("div",{className:"App"},c.a.createElement(o.a,null,c.a.createElement(m,{path:"/Chat-App",exact:!0,component:x}),c.a.createElement(l.b,{path:"/login",component:A}),c.a.createElement(l.b,{path:"/signup",component:I})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var F=a(28),T=a(45),B={users:[],talkingwith:"",conversations:[]},M={FirstName:"",LastName:" ",email:"",authenticating:!1,authenticated:!1,error:null},z=Object(F.c)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"".concat(b,"_REQUEST"):e=Object(j.a)(Object(j.a)({},e),{},{authenticating:!0});break;case"".concat(b,"_SUCCESS"):e=Object(j.a)(Object(j.a)(Object(j.a)({},e),t.payload.user),{},{authenticated:!0,authenticating:!1});break;case"".concat(b,"_FAILURE"):e=Object(j.a)(Object(j.a)({},e),{},{error:t.payload.error,authenticated:!1,authenticating:!1});break;case"".concat(v,"_REQUEST"):break;case"".concat(v,"_SUCCESS"):e=Object(j.a)({},M);break;case"".concat(v,"_FAILURE"):e=Object(j.a)(Object(j.a)({},e),{},{error:t.payload.error})}return e},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"".concat(O,"_REQUEST"):break;case"".concat(O,"_SUCCESS"):e=Object(j.a)(Object(j.a)({},e),{},{users:t.payload.users});break;case S:e=Object(j.a)(Object(j.a)({},e),{},{conversations:t.payload.conversations,talkingwith:t.payload.talkingwith});break;case y:e=Object(j.a)(Object(j.a)({},e),{},{newmessages:t.payload.messages})}return e}}),D=Object(F.d)(z,Object(F.a)(T.a));a(86);E.a.initializeApp({apiKey:"AIzaSyBwgSea1nJXF2dr4CVgF7U9v4s8mYPOsCg",authDomain:"chat-app-f6ff0.firebaseapp.com",databaseURL:"https://chat-app-f6ff0.firebaseio.com",projectId:"chat-app-f6ff0",storageBucket:"chat-app-f6ff0.appspot.com",messagingSenderId:"128106480680",appId:"1:128106480680:web:af3f88cb6e8e04f57d211d",measurementId:"G-Q6VRBKS781"}),window.store=D,s.a.render(c.a.createElement(i.a,{store:D},c.a.createElement(c.a.StrictMode,null,c.a.createElement(R,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[48,1,2]]]);
//# sourceMappingURL=main.b91bea10.chunk.js.map